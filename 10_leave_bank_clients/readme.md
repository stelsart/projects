Отток клиентов банка
Статус проекта: Завершен

Необходимо спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Необходимо построить модель с предельно большим значением F1-меры и  довести метрику до 0.59. 

Дополнительно измерить AUC-ROC, сравнивайте её значение с F1-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling]

Описание данных

Признаки
RowNumber — индекс строки в данных
CustomerId — уникальный идентификатор клиента
Surname — фамилия
CreditScore — кредитный рейтинг
Geography — страна проживания
Gender — пол
Age — возраст
Tenure — сколько лет человек является клиентом банка
Balance — баланс на счёте
NumOfProducts — количество продуктов банка, используемых клиентом
HasCrCard — наличие кредитной карты
IsActiveMember — активность клиента
EstimatedSalary — предполагаемая зарплата
Целевой признак

Exited — факт ухода клиента


Вывод
Загружен датасет с 10 тыс записями клиентов банка. В нем представлены клиенты со следующими параметрами:

Крединтный рейтинг от 350 до 850. В среднем 650
Возраст от 18 до 92 лет. В среднем 37-39
Клиенты пользуются услугами банка от 0 до 10 лет. В среднем 5 лет
Баланс на счете от 0 до 250 тыс. В среднем 76 тыс
Кол-во продуктов, которыми пользуются от 1 до 4. В среднем 1
У большинства клиентов (около 70%) есть кредитные карты
Более половины клиентов (окло 51%) являются активными пользователями
Зарплата от 11 до 199992, в среднем 100000.
Около 20% клиентов банка из датасета ушли из банка.
55% клиентов мужчины и 45% женщины
50% клиентов из Франции, 25% из Германнии и 25% из Испании
Явных дубликатов не обнаружено. Неявных дубликактов так же нет, как по Id клиента, так и по столбца фамилия, страна, возвраст, пол и зарплата. Перевели названия столбцов к нижнему регистру

Есть столбец с пустыми данными по кол-ву лет использования услуг. Возможно при выгрузке данных возинка тезническая ошибка или человеческий фактор при внесении данных в систему. Заменим данные на 0. Так же уберем фаилии клиентов(тк есть точное соотве-ие фамилии и id и проводим прямое кодирование по двум оставшимся столбцам оbject: Страна и пол, для дальнейшего обучения. Так же разделим выборку на обучающую, валидационну и тестовую в пропорции 60 на 20 на 20.

В таргете у нас виден дисбаланс классво 20 на 80. Мы обучили 3 модели на обучаующей выборке и обнаружили, что лучший результат f1 меры получается в модели случайный лес с 30 деревьями и глубиной 15. Полученная f1 мера 0.54 меньше метрики 0.59, заявленной в ТЗ.

Введя дополнительный гиперпараметр веса класса мы получили лучшую f1 меру 0.62 и AUC-ROC 0.85 в модели случайного леса с 60 деревьями и глубиной 9, соответвующую ТЗ (больше 0.59)

Мы произвели увеличение выборки для попытки ликвидировать дисбаланс классов. В сравнении с предыдущим методом, это не привело к существенному улучшению метрик. Лучшая модель - случайный лес с 30 деревьями и глубиной 11 дала метрику f1 0.63 и AUC-ROC 0.85

При использовании улчшей модели случайный лес с 60 деревьями и глубиной 9, с гиперпарамтров вес классов мы получили на тестовой выборке меру f1=0.62 и AUC-ROC=0.85.

Была оубчена модель для прогнозирования оттока клиентов соответвующая размеру метрики f1, указанной в ТЗ