Определение стоимости автомобилей

Сервис по продаже автомобилей с пробегом разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В наличии исторические данные: технические характеристики, комплектации и цены автомобилей. Необходимо построить модель для определения стоимости.

Важные параметры:

качество предсказания;
скорость предсказания;
время обучения.

Признаки:

• DateCrawled — дата скачивания анкеты из базы
• VehicleType — тип автомобильного кузова
• RegistrationYear — год регистрации автомобиля
• Gearbox — тип коробки передач
• Power — мощность (л. с.)
• Model — модель автомобиля
• Kilometer — пробег (км)
• RegistrationMonth — месяц регистрации автомобиля
• FuelType — тип топлива
• Brand — марка автомобиля
• Repaired — была машина в ремонте или нет
• DateCreated — дата создания анкеты
• NumberOfPictures — количество фотографий автомобиля
• PostalCode — почтовый индекс владельца анкеты (пользователя)
• LastSeen — дата последней активности пользователя
Целевой признак Price — цена (евро)

Вывод
Был загружен датасет с 16 параметрами. Параметры VehicleType, Gearbox, Model, FuelType, Repaired - содержат пропуски. Они образовались из-за технической ошибки при выгрузке или человеческий фактор - были пропущены при заполнении анкеты. Мы приняли решение создать доп. столбец - месяц продажи, тк на цену может оказывать влияние сезонность. Данные выгружены с марта 2014 по апрель 2016 года. Столбцы 'DateCrawled', 'DateCreated', 'LastSeen', 'RegistrationMonth', 'NumberOfPictures' - считаем не информативными и не влияющими на стоимость автомобиля, поэтому они были удалены. Так же в связи с невозможность восстановить - были заменены на unknown строки с пропусками по столбцам VehicleType, Gearbox, Model, FuelType, Repaired - тк они могу оказывать существенное влияние на цену. Так же были удалены 1-3 и 99 квантили в данных, тк наблюдались аномалии в параметрах 'Price', 'RegistrationYear' и 'Power'. После подготовки в датафрейме осталось 293415 строк (83% исходных данных)

При проверке моделей при кросс валидации и поиске лучших гиперпарметров на тренировочной выборке мы получили:

Линейная регрессия обучается 19.5 сек. Делает предсказание за 798 мс. RMSE = 2555.
CatBoostRegressor обучается за 17.6 сек. Делает предсказание за 449 мс. RMSE = 1580.
LGBMRegressor обучается за 19.3 сек. Делает предсказание за 6.62 сек. RMSE = 1630.
Исходя из этого мы вибираем модель CatBoostRegressor - как лидера по времени обучения, предсказания и показателю rmse.

Показатель и скорость предсказания на тесте у лучшей модели Catboost - время 131 мс, rmse = 1617. Рекомендуем сервису «Не бит, не крашен» использовать модель CatBoostRegressor для своего нового приложения по оценке стоимости авто.